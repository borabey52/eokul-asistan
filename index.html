<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e-Okul Excel AsistanÄ±</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-width: 500px; text-align: center; }
        .bookmark-btn {
            display: inline-block;
            background: #8e44ad; /* Mor renk: Excel modu */
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 18px;
            border: 2px dashed #9b59b6;
            cursor: grab;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.4);
            transition: transform 0.2s;
        }
        .bookmark-btn:hover { transform: scale(1.05); }
    </style>
</head>
<body>

    <div class="card">
        <h1>ğŸ“Š e-Okul Excel AsistanÄ±</h1>
        <p>Listenizi yapÄ±ÅŸtÄ±rÄ±n, notlarÄ± kiÅŸiye Ã¶zel otomatik daÄŸÄ±tÄ±n.</p>

        <a class="bookmark-btn" href="javascript:(function(){try{if(document.getElementById('gemini-excel-panel')){return}var d=document.createElement('div');d.id='gemini-excel-panel';d.style.cssText='position:fixed;top:80px;right:20px;width:300px;background:#fff;border:2px solid #2c3e50;border-radius:10px;z-index:99999;padding:15px;box-shadow:0 8px 30px rgba(0,0,0,0.4);font-family:sans-serif;max-height:80vh;overflow-y:auto;';d.innerHTML='<div style=\'display:flex;justify-content:space-between;margin-bottom:10px;\'><b style=\'color:#2c3e50\'>ğŸ“Š Excel Modu</b><span onclick=\'this.parentNode.parentNode.remove()\' style=\'cursor:pointer;font-weight:bold;color:red\'>X</span></div><textarea id=\'excelData\' placeholder=\'Excelden Kopyala-YapÄ±ÅŸtÄ±r:\nAd Soyad  Durum\nAhmet     Ä°yi\nAyÅŸe      Orta\' style=\'width:100%;height:80px;font-size:11px;border:1px solid #ccc;padding:5px;box-sizing:border-box;\'></textarea><button onclick=\'window.veriyiIsle()\' style=\'width:100%;margin:5px 0;background:#34495e;color:white;border:none;padding:5px;cursor:pointer;\'>Listeyi Kaydet ğŸ’¾</button><div id=\'ogrenciDurum\' style=\'padding:10px;background:#e8f6f3;margin:10px 0;border-radius:5px;font-size:13px;font-weight:bold;color:#16a085;display:none\'></div><div id=\'manuelSecim\' style=\'margin-top:10px;display:none\'><select id=\'ogrenciSelect\' style=\'width:100%;padding:5px;margin-bottom:5px;\'></select><button onclick=\'window.seciliDoldur()\' style=\'width:100%;background:#27ae60;color:white;border:none;padding:10px;border-radius:5px;font-weight:bold;\'>âœ… SeÃ§ili Ã–ÄŸrenciyi Doldur</button></div><div style=\'border-top:1px solid #eee;margin-top:10px;padding-top:10px;font-size:11px;color:#7f8c8d;\'>Manuel Ä°ÅŸlemler:</div><button onclick=\'window.gD(&quot;4&quot;)\' style=\'width:30%;margin:2px;font-size:10px;background:#ddd;border:none;padding:5px;\'>Hepsi 4</button><button onclick=\'window.gD(&quot;3&quot;)\' style=\'width:30%;margin:2px;font-size:10px;background:#ddd;border:none;padding:5px;\'>Hepsi 3</button><button onclick=\'window.gD(&quot;karisik&quot;)\' style=\'width:30%;margin:2px;font-size:10px;background:#ddd;border:none;padding:5px;\'>Rastgele</button><label style=\'font-size:11px;display:block;margin-top:5px;cursor:pointer\'><input type=\'checkbox\' id=\'gAutoSave\' checked> Otomatik Kaydet</label>';document.body.appendChild(d);window.ogrenciListesi={};window.veriyiIsle=function(){var raw=document.getElementById('excelData').value;var lines=raw.split('\n');var count=0;var select=document.getElementById('ogrenciSelect');select.innerHTML='';window.ogrenciListesi={};lines.forEach(function(line){var parts=line.split('\t');if(parts.length<2)parts=line.split(' ');if(parts.length>=2){var dur=parts.pop().trim().toLowerCase();var ad=parts.join(' ').trim();if(ad.length>2){window.ogrenciListesi[ad]=dur;var opt=document.createElement('option');opt.value=ad;opt.text=ad+' ('+dur+')';select.add(opt);count++}}});if(count>0){alert(count+' Ã¶ÄŸrenci listeye alÄ±ndÄ±!');document.getElementById('manuelSecim').style.display='block';window.autoDetect()}else{alert('Liste formatÄ± anlaÅŸÄ±lamadÄ±. Excelden kopyaladÄ±ÄŸÄ±nÄ±za emin olun.')}};window.autoDetect=function(){var pageText=document.body.innerText;var bulunan=null;for(var ad in window.ogrenciListesi){if(pageText.includes(ad)){bulunan=ad;break}}if(bulunan){var durum=window.ogrenciListesi[bulunan];document.getElementById('ogrenciSelect').value=bulunan;document.getElementById('ogrenciDurum').style.display='block';document.getElementById('ogrenciDurum').innerText='Tespit Edilen: '+bulunan+'\nDurum: '+durum.toUpperCase();window.seciliDoldur(true)}else{document.getElementById('ogrenciDurum').style.display='none'}};window.seciliDoldur=function(oto){var ad=document.getElementById('ogrenciSelect').value;var durum=window.ogrenciListesi[ad];var seviye='2';if(durum.includes('iyi')||durum.includes('pekiyi'))seviye='iyi';else if(durum.includes('zayÄ±f')||durum.includes('kÃ¶tÃ¼'))seviye='zayÄ±f';else seviye='orta';window.ozelDagit(seviye);if(oto!==true)alert(ad+' iÃ§in '+durum+' notlarÄ± girildi.')};window.ozelDagit=function(tip){var gr={};document.querySelectorAll('input[type=\'radio\']').forEach(function(r){if(r.name){if(!gr[r.name])gr[r.name]=[];gr[r.name].push(r)}});for(var n in gr){var val='2';var rnd=Math.random();if(tip==='iyi'){val=rnd<0.7?'4':'3'}else if(tip==='zayÄ±f'){val=rnd<0.6?'1':'2'}else{val=rnd<0.2?'1':(rnd<0.8?'2':'3')}gr[n].forEach(function(r){if(r.value==val)r.click()})}if(document.getElementById('gAutoSave').checked){setTimeout(function(){var b=document.querySelector('a[onclick*=\'Kaydet\']')||document.querySelector('.btn-success');if(b)b.click()},500)}};window.gD=function(s){window.ozelDagit(s=='4'?'iyi':(s=='karisik'?'orta':'zayÄ±f'))}}catch(e){alert('Hata: '+e)}})();">
            Excel AsistanÄ± (SÃ¼rÃ¼kle v3)
        </a>
        
        <p style="font-size: 13px; color: #7f8c8d; margin-top:20px;">
            <b>NasÄ±l KullanÄ±lÄ±r?</b><br>
            1. Butonu yer imlerine sÃ¼rÃ¼kleyin.<br>
            2. Excel'den Ä°sim ve Durum sÃ¼tunlarÄ±nÄ± kopyalayÄ±n.<br>
            3. Paneldeki kutuya yapÄ±ÅŸtÄ±rÄ±p "Listeyi Kaydet" deyin.<br>
            4. Sistem ekrandaki Ã¶ÄŸrenciyi isminden tanÄ±r ve otomatik doldurur!
        </p>
    </div>

</body>
</html>
